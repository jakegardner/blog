
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Routing with Redux</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../favicon.ico">

    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.min.css?v=0a7757e43e">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Droid+Serif:300,400,700,400italic%7COpen+Sans" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=0a7757e43e">
    <link rel="stylesheet" type="text/css" href="../assets/css/blog.css?v=0a7757e43e">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/darkula.min.css">

    <link rel="canonical" href="index.html">
    
    <meta property="og:site_name" content="Jake Gardner">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Routing with Redux">
    <meta property="og:description" content="Last weekend I put together my first Redux application by refactoring an old demo. Once you get familiar, the architecture seems like a very natural way to build applications. One area that took some time to figure out was that...">
    <meta property="og:url" content="http://localhost:2368/routing-with-redux/">
    <meta property="article:published_time" content="2016-01-12T05:22:30.890Z">
    <meta property="article:modified_time" content="2016-01-12T05:22:30.887Z">
    <meta property="article:tag" content="react">
    <meta property="article:tag" content="redux">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Routing with Redux">
    <meta name="twitter:description" content="Last weekend I put together my first Redux application by refactoring an old demo. Once you get familiar, the architecture seems like a very natural way to build applications. One area that took some time to figure out was that...">
    <meta name="twitter:url" content="http://localhost:2368/routing-with-redux/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Jake Gardner",
    "author": {
        "@type": "Person",
        "name": "Jake Gardner",
        "url": "http://localhost:2368/author/jake",
        "sameAs": null
    },
    "headline": "Routing with Redux",
    "url": "http://localhost:2368/routing-with-redux/",
    "datePublished": "2016-01-12T05:22:30.890Z",
    "dateModified": "2016-01-12T05:22:30.887Z",
    "keywords": "react, redux",
    "description": "Last weekend I put together my first Redux application by refactoring an old demo. Once you get familiar, the architecture seems like a very natural way to build applications. One area that took some time to figure out was that..."
}
    </script>

    <meta name="generator" content="Ghost 0.5">
    <link rel="alternate" type="application/rss+xml" title="Jake Gardner" href="../rss/index.html">
</head>
<body class="post-template tag-react tag-redux">
    <nav class="navbar" role="navigation">
        <div class="container-fluid">
            <div class="row">
                <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 navbar-header">
                    <span class="navbar-brand">
                        <a href="../"><span class="nav-link">Jake Gardner</span></a>
                    </span>
                    <ul class="navbar-social">
                        <li><a class="social-link" href="https://github.com/jakegardner"><span class="fa fa-github fa-lg fa-fw"></span></a></li>
                        <li><a class="social-link" href="https://twitter.com/jakegardnr"><span class="fa fa-twitter fa-lg fa-fw"></span></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    


<main class="post-content" role="main">

    <article class="post tag-react tag-redux">

        <header class="post-header">
            <h1 class="post-title">Routing with Redux</h1>
            <section class="post-meta">
                 on <a href="../tag/react/">react</a>, <a href="../tag/redux/">redux</a>
            </section>
        </header>

        <section class="post-content">
            <p>Last weekend I put together my first Redux <a href="https://github.com/jakegardner/redux-bookcatalog">application</a> by refactoring an old demo. Once you get familiar, the architecture seems like a very natural way to build applications.</p>

<p>One area that took some time to figure out was that of routing. While you can use <a href="https://github.com/rackt/react-router">react-router</a>, you need to do some extra wiring to get your state flowing as you would expect with vanilla React. </p>

<p>There are two projects to provide a seamless integration with Redux architecture, <a href="https://github.com/acdlite/redux-router">redux-router</a> and <a href="https://github.com/rackt/redux-simple-router">redux-simple-router</a>. Redux-router, at time of writing, is considered experimental, so I went with the redux-simple-router. It integrates seamlessly with react-router and redux.</p>

<p>I flet that some details were missing from documentation of integrating these projects, so I'm writing this simple how-to in the hopes that it helps someone else in the same situation in the future :)</p>

<h4 id="background">Background</h4>

<p>Here I will provide some information on the components you need to get this working, namely react-router and redux-simple-router.</p>

<h6 id="reactrouter">React-router</h6>

<p>The key rendered component of <a href="https://github.com/rackt/react-router">react-router</a> is the Router:</p>

<pre><code>&lt;Router /&gt;
</code></pre>

<p>Inside your Router element, you will put one or more Route elements: </p>

<pre><code>&lt;Router&gt;
    &lt;Route path="/" component={App} /&gt;
&lt;/Router&gt;
</code></pre>

<p>Each Route element can also have child routes:</p>

<pre><code>&lt;Router&gt;
    &lt;Route path="/" component={App}&gt;
            &lt;Route path="home" component={Home} /&gt;
    &lt;/Route&gt;
&lt;/Router&gt;
</code></pre>

<p>As you might expect, each Route element defines the expected route and the component should be rendered when hitting that route.</p>

<p>Where do the routes get rendered?</p>

<p>In the render method of a component with child routes (e.g. App in the above example), you will add something like this:</p>

<pre><code>&lt;div&gt;
    {this.props.children}
&lt;/div&gt;
</code></pre>

<p><code>{this.props.children}</code> identifies where in the render method child routes should be rendered. So for the /home route, the Home component would replace the contents of this div. </p>

<h6 id="reduxsimplerouter">Redux-simple-router</h6>

<p>Redux-simple-router simply (ha!) stores your router state in your Redux store. So, whereever you have connected a React component to your store, you can access routing parameters, path etc as a property of state i.e. <code>state.router</code>.</p>

<p>This is enabled by this statement:</p>

<pre><code>syncReduxAndRouter(history, store, (state) =&gt; state.router);
</code></pre>

<p>This should be included where you create your store. Don't worry; there is an example coming.</p>

<h4 id="letsmakethishappen">Let's make this happen</h4>

<p>Now that we have some fundamental understanding, let's apply it.</p>

<h6 id="installreactrouterreduxsimplerouter">Install react-router, redux-simple-router</h6>

<p>If you haven't already, run these:</p>

<pre><code>npm install --save react-router
npm install --save redux-simple-router
</code></pre>

<h6 id="setupreduxsimplerouter">Setup redux-simple-router</h6>

<p>The following should be in your application entry point file (I call mine index.js).</p>

<p>This is where the store is created, and the syncReduxAndRouter function is called.</p>

<pre><code>import React, { Component, PropTypes } from "react";
import { render } from "react-dom";
import { createHistory, useBasename } from "history";
import { syncReduxAndRouter } from "redux-simple-router";
import routes from "./routes";
import Root from "./containers/Root";
import configureStore from "./store/configureStore";

const history = useBasename(createHistory)({
  basename: JSON.stringify(process.env.BASENAME || "/")
});
const store = configureStore();

syncReduxAndRouter(history, store, (state) =&gt; state.router);

render(
  &lt;Root history={history} routes={routes} store={store} /&gt;,
  document.getElementById("root")
);
</code></pre>

<p>After syncing redux and the router, the routes and store are passed as props to the Root container (component).</p>

<p>The store parameter is the <a href="http://rackt.org/redux/docs/api/Store.html">Redux store</a> returned by createStore(). The history parameter is created by createHistory(). The routes parameter are the routes defined as <a href="https://facebook.github.io/jsx/">JSX</a> in another file (see below). These can also be specified inline.</p>

<h6 id="addrouterelement">Add Router element</h6>

<p>In the Root component file, and inside of your <a href="index.html">Provider</a> element, add the Router element:</p>

<pre><code>&lt;Provider store={this.props.store}&gt;
    &lt;Router history={this.props.history}&gt;
      {this.props.routes}
    &lt;/Router&gt;
&lt;/Provider&gt;
</code></pre>

<p>The props in this snippet are the same that we defined and passed in the previous code sample.</p>

<p>So the full Root component source should look like:</p>

<pre><code>  import React, { Component, PropTypes } from "react";
  import { Provider } from "react-redux";
  import { Router } from "react-router";

  class Root extends Component {
    render() {
      return (
        &lt;Provider store={this.props.store}&gt;
          &lt;Router history={this.props.history}&gt;
            {this.props.routes}
          &lt;/Router&gt;
        &lt;/Provider&gt;
      );
    }
  }
  Root.propTypes = {
    history: PropTypes.object.isRequired,
    routes: PropTypes.element.isRequired,
    store: PropTypes.object.isRequired
  };

export default Root;
</code></pre>

<h6 id="configureroutes">Configure routes</h6>

<p>Now to define the routes. Add a top-level route and any needed sub-routes: </p>

<pre><code>&lt;Route path="/" component={App}&gt;
    &lt;IndexRoute component={Home} /&gt;
    &lt;Route path="/book/:bookId" component={Detail} /&gt;
&lt;/Route&gt;
</code></pre>

<p>The parent <a href="https://github.com/rackt/react-router/blob/latest/docs/guides/basics/RouteConfiguration.md">Route</a> element with the root path encloses any other routes in your application.</p>

<p>The <a href="https://github.com/rackt/react-router/blob/latest/docs/guides/basics/IndexRoutes.md">IndexRoute</a> is a special element that allows you to specify which component should receive the request with no additional route information, i.e. the root path. Even though this element specifies the destination, I found that the path and component properties in the parent Route element were required.</p>

<p>Finally, the child Route element specifies a sub-route of the root with a route parameter indicated by the leading colon. This parameter will be available as <code>state.router.params.bookId</code>.</p>

<p>The full routes source file should look like: </p>

<pre><code>import React, { Component, PropTypes } from "react";
import { Route, IndexRoute } from "react-router";
import App from "../components/App";
import Home from "../components/Home";
import Detail from "../components/Detail";

export default (
      &lt;Route path="/" component={App}&gt;
        &lt;IndexRoute component={Home} /&gt;
        &lt;Route path="/book/:bookId" component={Detail} /&gt;
      &lt;/Route&gt;
);
</code></pre>

<p>Save this as <code>/routes/index.js</code> or wherever is appropriate, but make sure to update the include path in the Root component file.</p>

<h6 id="modifystateparameterincomponents">Modify state parameter in components</h6>

<p>The final step is to check any components that receive state. Before the routing configuration, your state object may have had the properties you defined at the root of the object. Afterwards, I found that the state object now includes a child object for the router and one for the reducer. Whatever state is returned by the <a href="http://rackt.org/redux/docs/basics/Reducers.html">reducer</a> is a child of this child reducer object, like so:</p>

<pre><code>state = {
    router: {
        changeId: 1,
        path: "/book/12",
        replace: false,
        state: ...
    },
    reducer: {
        *state here*
    }
}
</code></pre>

<p>The reducer will be named after your reducer. Update your props declarations or mapStateToProps methods as appropriate to ensure that <a href="http://rackt.org/redux/docs/basics/DataFlow.html">state flows</a> to your components as you expect.</p>
        </section>

        <time class="post-date" datetime="2016-01-11">11 January 2016</time>
        <footer class="post-footer">



            <section class="author">
                <h4><a href="http://localhost:2368/author/jake/">Jake Gardner</a></h4>

                    <p>Read <a href="http://localhost:2368/author/jake/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/share?text=Routing%20with%20Redux&amp;url=http://localhost:2368/routing-with-redux/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/routing-with-redux/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://localhost:2368/routing-with-redux/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

            <div id="disqus_thread"></div>
            <script>
                var disqus_config = function () {
                    this.page.url = "http://localhost:2368/routing-with-redux/";
                    this.page.identifier = "/routing-with-redux/";
                    this.page.title = "Routing with Redux";
                };
                (function() {
                var d = document, s = d.createElement('script');
                s.src = '//blogjakegardnerme.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        </footer>

    </article>

</main>



    <script src="../public/jquery.js?v=0a7757e43e"></script>

    <!-- <script type="text/javascript" src="/assets/js/jquery.fitvids.js?v=0a7757e43e"></script>
    // <script type="text/javascript" src="/assets/js/index.js?v=0a7757e43e"></script> -->


    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-70122057-1', 'auto');
      ga('send', 'pageview');

    </script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</body>
